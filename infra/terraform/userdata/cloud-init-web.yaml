#cloud-config
package_update: true
packages:
  - nginx
  - git
  - curl

write_files:
  - path: /etc/motd
    content: |
      This instance was provisioned by Terraform + cloud-init

runcmd:
  # start nginx
  - systemctl enable nginx
  - systemctl start nginx

  # install Puppet agent (example - adapt for your distro)
  - curl -O https://apt.puppet.com/puppet7-release-focal.deb || true
  - dpkg -i puppet7-release-focal.deb || true
  - apt-get update || true
  - apt-get install -y puppet-agent || true
  - /opt/puppetlabs/bin/puppet agent --test || true

  # place a simple index page
  - echo '<h1>Hello from cloud-init + Terraform</h1>' > /var/www/html/index.html
# end of cloud-config
